(self["webpackChunkaw_webui"]=self["webpackChunkaw_webui"]||[]).push([[62],{2523:e=>{function t(e,t,r,n){var s=e.length,a=r+(n?1:-1);while(n?a--:++a<s)if(t(e[a],a,e))return a;return-1}e.exports=t},15325:(e,t,r)=>{var n=r(96131);function s(e,t){var r=null==e?0:e.length;return!!r&&n(e,t,0)>-1}e.exports=s},17400:(e,t,r)=>{var n=r(99374),s=1/0,a=17976931348623157e292;function i(e){if(!e)return 0===e?e:0;if(e=n(e),e===s||e===-s){var t=e<0?-1:1;return t*a}return e===e?e:0}e.exports=i},29905:e=>{function t(e,t,r){var n=-1,s=null==e?0:e.length;while(++n<s)if(r(t,e[n]))return!0;return!1}e.exports=t},30514:(e,t,r)=>{var n=r(34932);function s(e,t){return n(t,(function(t){return e[t]}))}e.exports=s},31800:e=>{var t=/\s/;function r(e){var r=e.length;while(r--&&t.test(e.charAt(r)));return r}e.exports=r},32865:(e,t,r)=>{var n=r(97189),s=r(51811),a=s(n);e.exports=a},33031:(e,t,r)=>{var n=r(83120),s=r(46155),a=r(69302),i=r(36800),u=a((function(e,t){if(null==e)return[];var r=t.length;return r>1&&i(e,t[0],t[1])?t=[]:r>2&&i(t[0],t[1],t[2])&&(t=[t[0]]),s(e,n(t,1),[])}));e.exports=u},35880:(e,t,r)=>{var n=r(30514),s=r(95950);function a(e){return null==e?[]:n(e,s(e))}e.exports=a},35970:(e,t,r)=>{var n=r(83120);function s(e){var t=null==e?0:e.length;return t?n(e,1):[]}e.exports=s},36800:(e,t,r)=>{var n=r(75288),s=r(64894),a=r(30361),i=r(23805);function u(e,t,r){if(!i(r))return!1;var u=typeof t;return!!("number"==u?s(r)&&a(t,r.length):"string"==u&&t in r)&&n(r[t],e)}e.exports=u},37334:e=>{function t(e){return function(){return e}}e.exports=t},44517:(e,t,r)=>{var n=r(76545),s=r(63950),a=r(84247),i=1/0,u=n&&1/a(new n([,-0]))[1]==i?function(e){return new n(e)}:s;e.exports=u},50014:(e,t,r)=>{var n=r(15389),s=r(55765);function a(e,t){return e&&e.length?s(e,n(t,2)):[]}e.exports=a},51811:e=>{var t=800,r=16,n=Date.now;function s(e){var s=0,a=0;return function(){var i=n(),u=r-(i-a);if(a=i,u>0){if(++s>=t)return arguments[0]}else s=0;return e.apply(void 0,arguments)}}e.exports=s},54128:(e,t,r)=>{var n=r(31800),s=/^\s+/;function a(e){return e?e.slice(0,n(e)+1).replace(s,""):e}e.exports=a},55765:(e,t,r)=>{var n=r(38859),s=r(15325),a=r(29905),i=r(19219),u=r(44517),o=r(84247),c=200;function l(e,t,r){var l=-1,f=s,v=e.length,d=!0,p=[],h=p;if(r)d=!1,f=a;else if(v>=c){var _=t?null:u(e);if(_)return o(_);d=!1,f=i,h=new n}else h=t?[]:p;e:while(++l<v){var g=e[l],m=t?t(g):g;if(g=r||0!==g?g:0,d&&m===m){var y=h.length;while(y--)if(h[y]===m)continue e;t&&h.push(m),p.push(g)}else f(h,m,r)||(h!==p&&h.push(m),p.push(g))}return p}e.exports=l},56757:(e,t,r)=>{var n=r(91033),s=Math.max;function a(e,t,r){return t=s(void 0===t?e.length-1:t,0),function(){var a=arguments,i=-1,u=s(a.length-t,0),o=Array(u);while(++i<u)o[i]=a[t+i];i=-1;var c=Array(t+1);while(++i<t)c[i]=a[i];return c[t]=r(o),n(e,this,c)}}e.exports=a},61489:(e,t,r)=>{var n=r(17400);function s(e){var t=n(e),r=t%1;return t===t?r?t-r:t:0}e.exports=s},62193:(e,t,r)=>{var n=r(88984),s=r(5861),a=r(72428),i=r(56449),u=r(64894),o=r(3656),c=r(55527),l=r(37167),f="[object Map]",v="[object Set]",d=Object.prototype,p=d.hasOwnProperty;function h(e){if(null==e)return!0;if(u(e)&&(i(e)||"string"==typeof e||"function"==typeof e.splice||o(e)||l(e)||a(e)))return!e.length;var t=s(e);if(t==f||t==v)return!e.size;if(c(e))return!n(e).length;for(var r in e)if(p.call(e,r))return!1;return!0}e.exports=h},63950:e=>{function t(){}e.exports=t},69302:(e,t,r)=>{var n=r(83488),s=r(56757),a=r(32865);function i(e,t){return a(s(e,t,n),e+"")}e.exports=i},76959:e=>{function t(e,t,r){var n=r-1,s=e.length;while(++n<s)if(e[n]===t)return n;return-1}e.exports=t},79859:(e,t,r)=>{var n=r(96131),s=r(64894),a=r(85015),i=r(61489),u=r(35880),o=Math.max;function c(e,t,r,c){e=s(e)?e:u(e),r=r&&!c?i(r):0;var l=e.length;return r<0&&(r=o(l+r,0)),a(e)?r<=l&&e.indexOf(t,r)>-1:!!l&&n(e,t,r)>-1}e.exports=c},80062:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});r(19693);var n=function(){var e=this,t=e._self._c;return t("div",[t("h3",[e._v("Query Explorer")]),e._v("See "),t("a",{attrs:{href:"https://docs.activitywatch.net/en/latest/examples/querying-data.html"}},[e._v("the documentation")]),e._v(" for help on how to write queries."),t("hr"),e.error?t("div",{staticClass:"alert alert-danger"},[e._v(e._s(e.error))]):e._e(),t("form",[t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group col-md-6"},[e._v("Start"),t("input",{directives:[{name:"model",rawName:"v-model",value:e.startdate,expression:"startdate"}],staticClass:"form-control",attrs:{type:"date",max:e.today},domProps:{value:e.startdate},on:{input:function(t){t.target.composing||(e.startdate=t.target.value)}}})]),t("div",{staticClass:"form-group col-md-6"},[e._v("End"),t("input",{directives:[{name:"model",rawName:"v-model",value:e.enddate,expression:"enddate"}],staticClass:"form-control",attrs:{type:"date",max:e.tomorrow},domProps:{value:e.enddate},on:{input:function(t){t.target.composing||(e.enddate=t.target.value)}}})])]),t("div",{staticClass:"form-group"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.query_code,expression:"query_code"}],staticClass:"form-control",staticStyle:{"font-family":"monospace"},attrs:{rows:"10"},domProps:{value:e.query_code},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey?e.query():null},input:function(t){t.target.composing||(e.query_code=t.target.value)}}})]),t("div",{staticClass:"form-inline"},[t("div",{staticClass:"form-group"},[t("button",{staticClass:"btn btn-success",attrs:{type:"button"},on:{click:function(t){return e.query()}}},[e._v("Query")])]),t("span",{staticStyle:{"padding-left":"1em"}}),e._v(e._s(e.eventcount_str))])]),t("hr"),t("aw-selectable-eventview",{attrs:{events:e.events,event_type:e.event_type}})],1)},s=[],a=r(70068),i=r(1952),u=r(79859),o=r.n(u),c=r(62193),l=r.n(c),f=(r(68329),r(4895),r(87136),r(40173),r(30959),r(59581),r(95093)),v=r.n(f),d=r(99543),p=v()().startOf("day"),h=v()(p).add(24,"hours");const _={name:"QueryExplorer",data:function(){var e=this.$route.query.q;return l()(this.$route.query.q)&&(e='\nafk_events = query_bucket(find_bucket("aw-watcher-afk_"));\nwindow_events = query_bucket(find_bucket("aw-watcher-window_"));\nwindow_events = filter_period_intersect(window_events, filter_keyvals(afk_events, "status", ["not-afk"]));\nmerged_events = merge_events_by_keys(window_events, ["app", "title"]);\nmerged_events = categorize(merged_events, __CATEGORIES__);\nRETURN = sort_by_duration(merged_events);\n'.trim()),{query_code:e,event_type:"currentwindow",events:[],today:p.format(),tomorrow:h.format(),error:"",startdate:p.format("YYYY-MM-DD"),enddate:h.format("YYYY-MM-DD")}},computed:{eventcount_str:function(){return Array.isArray(this.events)?"Number of events: "+this.events.length:""}},methods:{query:function(){var e=(0,i.A)((0,a.A)().mark((function e(){var t,r,n,s;return(0,a.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.query_code,!o()(t,"__CATEGORIES__")){e.next=7;break}if(r=(0,d.n)().classes_for_query,0!==(0,d.n)().classes_for_query.length){e.next=6;break}return this.error="__CATEGORIES__ was used in query but no categories have been defined yet.",e.abrupt("return");case 6:t=t.replace("__CATEGORIES__",JSON.stringify(r));case 7:return t=t.split(";").map((function(e){return e.trim()+";"})),n=[v()(this.startdate).format()+"/"+v()(this.enddate).format()],e.prev=9,e.next=12,this.$aw.query(n,t);case 12:s=e.sent,this.events=s[0],this.error="",e.next=20;break;case 17:e.prev=17,e.t0=e["catch"](9),this.error=e.t0.response.data.message;case 20:case"end":return e.stop()}}),e,this,[[9,17]])})));function t(){return e.apply(this,arguments)}return t}()}},g=_;var m=r(81656),y=(0,m.A)(g,n,s,!1,null,"9b4b307e",null);const x=y.exports},85015:(e,t,r)=>{var n=r(72552),s=r(56449),a=r(40346),i="[object String]";function u(e){return"string"==typeof e||!s(e)&&a(e)&&n(e)==i}e.exports=u},85463:e=>{function t(e){return e!==e}e.exports=t},91033:e=>{function t(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}e.exports=t},94506:(e,t,r)=>{var n=r(93599),s=r(3335),a=r(83488);function i(e){return e&&e.length?n(e,a,s):void 0}e.exports=i},96131:(e,t,r)=>{var n=r(2523),s=r(85463),a=r(76959);function i(e,t,r){return t===t?a(e,t,r):n(e,s,r)}e.exports=i},97189:(e,t,r)=>{var n=r(37334),s=r(93243),a=r(83488),i=s?function(e,t){return s(e,"toString",{configurable:!0,enumerable:!1,value:n(t),writable:!0})}:a;e.exports=i},99374:(e,t,r)=>{var n=r(54128),s=r(23805),a=r(44394),i=NaN,u=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;function f(e){if("number"==typeof e)return e;if(a(e))return i;if(s(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=s(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=o.test(e);return r||c.test(e)?l(e.slice(2),r?2:8):u.test(e)?i:+e}e.exports=f},99543:(e,t,r)=>{"use strict";r.d(t,{n:()=>w});var n=r(55378),s=r.n(n),a=r(94506),i=r.n(a),u=r(35970),o=r.n(u),c=r(50014),l=r.n(c),f=r(33031),v=r.n(f),d=r(88055),p=r.n(d),h=r(2404),_=r.n(h),g=(r(14913),r(98741),r(18636),r(5086),r(59581),r(17),r(28743),r(80475),r(35231),r(80115),r(80749)),m=r(51278),y=r(38839);function x(e,t){if(e&&e.data&&e.data.score)return e.data.score;if(e&&e.name.slice(0,-1).length>0){var r=e.name.slice(0,-1),n=t.find((function(e){return _()(e.name,r)}));return x(n,t)}return 0}var w=(0,y.nY)("categories",{state:function(){return{classes:[],classes_unsaved_changes:!1}},getters:{classes_clean:function(){return this.classes.map(g.k8)},classes_hierarchy:function(){var e=(0,g.YB)(p()(this.classes));return v()(e,[function(e){return e.id||0}])},classes_for_query:function(){return this.classes.filter((function(e){return null!==e.rule.type})).map((function(e){return[e.name,e.rule]}))},all_categories:function(){return l()(o()(this.classes.map((function(e){for(var t=[],r=1;r<=e.name.length;r++)t.push(e.name.slice(0,r));return t}))),(function(e){return e.join(">>>>")}))},allCategoriesSelect:function(){var e=this.all_categories,t=e.map((function(e){return{text:e.join(" > "),value:e,id:e.id}}));return v()(t,"text")},get_category:function(){var e=this;return function(t){("string"===typeof t||t instanceof String)&&console.error("Passed category was string, expected array. Lookup will fail.");var r=e.classes.find((function(e){return _()(e.name,t)}));return r?(0,g.fz)(p()(r)):(_()(t,["Uncategorized"])||console.error("Couldn't find category: ",t),{name:["Uncategorized"],rule:{type:"none"}})}},get_category_by_id:function(){var e=this;return function(t){return(0,g.fz)(p()(e.classes.find((function(e){return e.id==t}))))}},get_category_color:function(){var e=this;return function(t){return(0,m._V)(e.get_category(t),e.classes)}},get_category_score:function(){var e=this;return function(t){return x(e.get_category(t),e.classes)}},category_select:function(){var e=this;return function(t){var r=e.all_categories;return r=r.map((function(e){return{text:e.join(" > "),value:e}})).sort((function(e,t){return e.text>t.text})),t&&(r=[{text:"All",value:null},{text:"Uncategorized",value:["Uncategorized"]}].concat(r)),r}}},actions:{load:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===e&&(e=(0,g.fw)()),e=(0,g.Cq)(e);var t=0;this.classes=e.map((function(e){return Object.assign(e,{id:t++})})),this.classes_unsaved_changes=!1},save:function(){var e=(0,g.UL)(this.classes);return this.classes_unsaved_changes=!1,e},import:function(e){var t=0;this.classes=e.map((function(e){return Object.assign(e,{id:t++})})),this.classes_unsaved_changes=!0},updateClass:function(e){console.log("Updating class:",e);var t=this.classes.find((function(t){return t.id===e.id})),r=t.name,n=t.name.length;void 0===e.id||null===e.id?(e.id=i()(s()(this.classes,"id"))+1,this.classes.push(e)):Object.assign(t,e),s()(this.classes,(function(t){_()(r,t.name.slice(0,n))&&(t.name=e.name.concat(t.name.slice(n)),console.log("Renamed child:",t.name))})),this.classes_unsaved_changes=!0},addClass:function(e){e.id=i()(s()(this.classes,"id"))+1,this.classes.push(e),this.classes_unsaved_changes=!0},removeClass:function(e){this.classes=this.classes.filter((function(t){return t.id!==e})),this.classes_unsaved_changes=!0},appendClassRule:function(e,t){var r=this.classes.find((function(t){return t.id===e}));"none"===r.rule.type||null===r.rule.type?(r.rule.type="regex",r.rule.regex=t):"regex"===r.rule.type&&(r.rule.regex+="|"+t),this.classes_unsaved_changes=!0},restoreDefaultClasses:function(){var e=0;this.classes=(0,g.Cq)(g.mT).map((function(t){return Object.assign(t,{id:e++})})),this.classes_unsaved_changes=!0},clearAll:function(){this.classes=[],this.classes_unsaved_changes=!0}}})}}]);
//# sourceMappingURL=62.1df8fc7e.js.map