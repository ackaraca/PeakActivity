"use strict";(self["webpackChunkaw_webui"]=self["webpackChunkaw_webui"]||[]).push([[6232],{6232:(t,e,r)=>{r.r(e),r.d(e,{default:()=>y});var a=function(){var t=this,e=t._self._c;return e("div",[e("h3",{staticClass:"mb-0"},[t._v("Trends for "+t._s(t._f("friendlyperiod")(t.timeperiod)))]),e("b-input-group",{attrs:{size:"sm"}},[e("b-form-select",{attrs:{label:"Host",options:t.bucketsStore.hosts,placeholder:"Select a hostname"},model:{value:t.host,callback:function(e){t.host=e},expression:"host"}})],1),e("div",{staticClass:"mb-2"},[e("ul",{staticClass:"list-group list-group-horizontal-md mb-3",staticStyle:{"font-size":"0.9em",opacity:"0.7"}},[e("li",{staticClass:"list-group-item pl-0 pr-3 py-0 border-0"},[e("b",[t._v("Host:")]),t._v(" "+t._s(t.host))])])]),e("b-alert",{staticStyle:{},attrs:{show:""}},[t._v("This feature is still in early development.")]),e("div",[e("aw-timeline-barchart",{attrs:{datasets:t.datasets,height:100}})],1),e("div",[e("hr"),e("h5",[t._v("Options")]),e("aw-devonly",[e("b-btn",{attrs:{id:"load-demo"},on:{click:t.load_demo}},[t._v("Load demo data")])],1)],1)],1)},n=[],i=r(70068),s=r(1952),o=r(95093),u=r.n(o),c=r(71056),l=r(13064),d=r(90296),p=r(99543),h=r(93834);const f={name:"Trends",props:{},data:function(){var t=(0,c.get_today_with_offset)(),e=7,r=u()(t).subtract(e,"days");return{bucketsStore:(0,d._)(),categoryStore:(0,p.n)(),activityStore:(0,h.e)(),today:t,timeperiod:{start:r,length:[e,"day"]}}},computed:{host:function(){return this.$route.params.host},datasets:function(){return(0,l.O)(this.activityStore.category.by_period,this.categoryStore.classes)}},mounted:function(){var t=(0,s.A)((0,i.A)().mark((function t(){return(0,i.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.categoryStore.load(),t.next=3,this.refresh();case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:{refresh:function(){var t=(0,s.A)((0,i.A)().mark((function t(e){var r;return(0,i.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={timeperiod:this.timeperiod,host:this.host,force:e,filter_afk:this.filter_afk,include_audible:this.include_audible,filter_categories:this.filter_categories,dont_query_inactive:!1},t.next=3,this.activityStore.query_category_time_by_period(r);case 3:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),load_demo:function(){var t=(0,s.A)((0,i.A)().mark((function t(){return(0,i.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.data={"2021-01":1e3,"2021-02":500};case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},m=f;var v=r(81656),_=(0,v.A)(m,a,n,!1,null,"7456416a",null);const y=_.exports},13064:(t,e,r)=>{r.d(e,{O:()=>u});var a=r(75530),n=r(2404),i=r.n(n),s=(r(5086),r(45708),r(29979),r(14602),r(41128),r(95843),r(59581),r(90345),r(80475),r(17),r(87136),r(58649),r(18636),r(98741),r(99764),r(51278)),o=r(99543);function u(t,e){var r=">>>",n=t;if(n){var u=new Set(Object.values(n).map((function(t){return t.cat_events.map((function(t){return t.data["$category"].join(r)}))})).flat()),c=(0,a.A)(u).map((function(t){var a=(0,o.n)(),u=a.get_category(t.split(r));if(u){var c=Object.values(n).map((function(t){var e=t.cat_events.find((function(t){return i()(t.data["$category"],u.name)}));return e?Math.round(e.duration/3600*1e3)/1e3:null}));return{label:u.name.join(" > "),backgroundColor:(0,s._V)(u,e),data:c}}console.error("missing category:",t)})).filter((function(t){return t}));return c}return[]}},99764:(t,e,r)=>{r.d(e,{F:()=>a});r(23181),r(59581),r(35231),r(79389),r(28743),r(95093),r(71056);function a(t,e){t=t.sort((function(t,e){return t.timestamp-e.timestamp})),e=e.sort((function(t,e){return t.timestamp-e.timestamp}));var r=0,a=0,n=[];while(r<t.length&&a<e.length){var i=t[r],s=e[a];if(t!==e||i!==s){var o=new Date(i.timestamp),u=new Date(s.timestamp),c=new Date(new Date(i.timestamp).valueOf()+1e3*i.duration),l=new Date(new Date(s.timestamp).valueOf()+1e3*s.duration);if(o<u&&u<c||o<l&&l<=c){var d={start:o,end:c,event:i},p={start:u,end:l,event:s};n.push([d,p])}s.timestamp+1e3*s.duration>i.timestamp+1e3*i.duration?r++:a++}else r++}return n.length>0&&console.warn("Overlapping events found",n),n}}}]);
//# sourceMappingURL=6232.1e43e4bf.js.map