{"version":3,"file":"js/4913.5d25142e.js","mappings":"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","sources":["webpack://aw-webui/./node_modules/lodash/head.js","webpack://aw-webui/./node_modules/lodash/_baseFilter.js","webpack://aw-webui/./node_modules/lodash/_castFunction.js","webpack://aw-webui/./node_modules/lodash/forEach.js","webpack://aw-webui/./src/visualizations/PeriodUsage.vue","webpack://aw-webui/./src/visualizations/periodusage.ts","webpack://aw-webui/./src/visualizations/PeriodUsage.vue?fe9e","webpack://aw-webui/./src/visualizations/PeriodUsage.vue?47a4","webpack://aw-webui/./node_modules/lodash/each.js","webpack://aw-webui/./node_modules/lodash/filter.js"],"sourcesContent":["/**\n * Gets the first element of `array`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @alias first\n * @category Array\n * @param {Array} array The array to query.\n * @returns {*} Returns the first element of `array`.\n * @example\n *\n * _.head([1, 2, 3]);\n * // => 1\n *\n * _.head([]);\n * // => undefined\n */\nfunction head(array) {\n  return (array && array.length) ? array[0] : undefined;\n}\n\nmodule.exports = head;\n","var baseEach = require('./_baseEach');\n\n/**\n * The base implementation of `_.filter` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction baseFilter(collection, predicate) {\n  var result = [];\n  baseEach(collection, function(value, index, collection) {\n    if (predicate(value, index, collection)) {\n      result.push(value);\n    }\n  });\n  return result;\n}\n\nmodule.exports = baseFilter;\n","var identity = require('./identity');\n\n/**\n * Casts `value` to `identity` if it's not a function.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Function} Returns cast function.\n */\nfunction castFunction(value) {\n  return typeof value == 'function' ? value : identity;\n}\n\nmodule.exports = castFunction;\n","var arrayEach = require('./_arrayEach'),\n    baseEach = require('./_baseEach'),\n    castFunction = require('./_castFunction'),\n    isArray = require('./isArray');\n\n/**\n * Iterates over elements of `collection` and invokes `iteratee` for each element.\n * The iteratee is invoked with three arguments: (value, index|key, collection).\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * **Note:** As with other \"Collections\" methods, objects with a \"length\"\n * property are iterated like arrays. To avoid this behavior use `_.forIn`\n * or `_.forOwn` for object iteration.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @alias each\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n * @see _.forEachRight\n * @example\n *\n * _.forEach([1, 2], function(value) {\n *   console.log(value);\n * });\n * // => Logs `1` then `2`.\n *\n * _.forEach({ 'a': 1, 'b': 2 }, function(value, key) {\n *   console.log(key);\n * });\n * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n */\nfunction forEach(collection, iteratee) {\n  var func = isArray(collection) ? arrayEach : baseEach;\n  return func(collection, castFunction(iteratee));\n}\n\nmodule.exports = forEach;\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('svg')\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import * as d3 from 'd3';\nimport _ from 'lodash';\nimport moment from 'moment';\nimport { seconds_to_duration, get_hour_offset } from '../util/time.ts';\nfunction create(svg_elem) {\n    // Clear element\n    svg_elem.innerHTML = '';\n}\nfunction set_status(svg_elem, msg) {\n    // Select svg canvas\n    svg_elem.innerHTML = '';\n    const svg = d3.select(svg_elem);\n    svg\n        .append('text')\n        .attr('x', '50%')\n        .attr('y', '25pt')\n        .text(msg)\n        .attr('font-family', 'sans-serif')\n        .attr('font-size', '20pt')\n        .attr('text-anchor', 'middle')\n        .attr('fill', '#AAA');\n}\nconst diagramcolor = '#aaa';\nconst diagramcolor_selected = '#fc5';\nconst diagramcolor_focused = '#adf';\nfunction update(svg_elem, usage_arr, onPeriodClicked) {\n    const dateformat = 'YYYY-MM-DD';\n    // No apps, sets status to \"No data\"\n    if (usage_arr.length <= 0) {\n        set_status(svg_elem, 'No data');\n        return;\n    }\n    svg_elem.innerHTML = '';\n    const svg = d3.select(svg_elem);\n    function get_usage_time(day_events) {\n        const day_event = _.head(_.filter(day_events, e => e.data.status == 'not-afk'));\n        return day_event != undefined ? day_event.duration : 0;\n    }\n    const usage_times = usage_arr.map(day_events => get_usage_time(day_events));\n    let longest_usage = Math.max.apply(null, usage_times);\n    // Avoid division by zero\n    if (longest_usage <= 0) {\n        longest_usage = 0.00000000001;\n    }\n    const padding = 0.3 * (100 / (usage_arr.length - 1));\n    const width = 100 / usage_arr.length - padding;\n    const center_elem = Math.floor(usage_arr.length / 2);\n    _.each(usage_arr, (events, i) => {\n        const usage_time = get_usage_time(events);\n        const height = 85 * (usage_time / longest_usage);\n        let date = '';\n        if (events.length > 0) {\n            // slice off so it's only the day\n            date = moment(events[0].timestamp).subtract(get_hour_offset(), 'hours').format(dateformat);\n        }\n        const color = i === center_elem ? diagramcolor_selected : diagramcolor;\n        const offset = 50;\n        const x = i * padding + i * width + 0.25 * width;\n        // FIXME: Doesn't work well, notably breaks on last7d and last30d\n        if (moment(date).isSame(moment(), 'day')) {\n            svg\n                .append('line')\n                .attr('x1', x + width / 2 + '%')\n                .attr('y1', 0)\n                .attr('x2', x + width / 2 + '%')\n                .attr('y2', 200)\n                .attr('style', 'stroke: #888; stroke-width: 2px;')\n                .attr('stroke-dasharray', '4, 2');\n            svg\n                .append('text')\n                .attr('x', x + 1.5 * width + '%')\n                .attr('y', '30')\n                .text('Today');\n        }\n        const rect = svg\n            .append('rect')\n            .attr('x', x + '%')\n            .attr('y', 101 - height + '%') // Draw rect bottom-up\n            .attr('rx', 3)\n            .attr('ry', 3)\n            .attr('style', i === center_elem ? 'stroke: black; stroke-width: 1;' : 'stroke: #222; stroke-width: 1;')\n            .attr('width', width + '%')\n            .attr('height', height + offset + '%')\n            .attr('color', color)\n            .attr('date', date)\n            .style('fill', color)\n            .on('mouseover', () => {\n            rect.style('fill', diagramcolor_focused);\n        })\n            .on('mouseout', e => {\n            rect.style('fill', e.target.attributes.color.value);\n        })\n            .on('click', function () {\n            onPeriodClicked(date);\n        });\n        rect.append('title').text(date + '\\n' + seconds_to_duration(usage_time));\n    });\n}\nexport default {\n    create: create,\n    update: update,\n    set_status: set_status,\n};\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/@vue/cli-plugin-typescript/node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-38.use[2]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PeriodUsage.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/@vue/cli-plugin-typescript/node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-38.use[2]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./PeriodUsage.vue?vue&type=script&lang=ts\"","import { render, staticRenderFns } from \"./PeriodUsage.vue?vue&type=template&id=2e34e86e&scoped=true&lang=pug\"\nimport script from \"./PeriodUsage.vue?vue&type=script&lang=ts\"\nexport * from \"./PeriodUsage.vue?vue&type=script&lang=ts\"\nimport style0 from \"./PeriodUsage.vue?vue&type=style&index=0&id=2e34e86e&prod&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2e34e86e\",\n  null\n  \n)\n\nexport default component.exports","module.exports = require('./forEach');\n","var arrayFilter = require('./_arrayFilter'),\n    baseFilter = require('./_baseFilter'),\n    baseIteratee = require('./_baseIteratee'),\n    isArray = require('./isArray');\n\n/**\n * Iterates over elements of `collection`, returning an array of all elements\n * `predicate` returns truthy for. The predicate is invoked with three\n * arguments: (value, index|key, collection).\n *\n * **Note:** Unlike `_.remove`, this method returns a new array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [predicate=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n * @see _.reject\n * @example\n *\n * var users = [\n *   { 'user': 'barney', 'age': 36, 'active': true },\n *   { 'user': 'fred',   'age': 40, 'active': false }\n * ];\n *\n * _.filter(users, function(o) { return !o.active; });\n * // => objects for ['fred']\n *\n * // The `_.matches` iteratee shorthand.\n * _.filter(users, { 'age': 36, 'active': true });\n * // => objects for ['barney']\n *\n * // The `_.matchesProperty` iteratee shorthand.\n * _.filter(users, ['active', false]);\n * // => objects for ['fred']\n *\n * // The `_.property` iteratee shorthand.\n * _.filter(users, 'active');\n * // => objects for ['barney']\n *\n * // Combining several predicates using `_.overEvery` or `_.overSome`.\n * _.filter(users, _.overSome([{ 'age': 36 }, ['age', 40]]));\n * // => objects for ['fred', 'barney']\n */\nfunction filter(collection, predicate) {\n  var func = isArray(collection) ? arrayFilter : baseFilter;\n  return func(collection, baseIteratee(predicate, 3));\n}\n\nmodule.exports = filter;\n"],"names":["head","array","length","undefined","module","exports","baseEach","baseFilter","collection","predicate","result","value","index","push","identity","castFunction","arrayEach","isArray","forEach","iteratee","func","render","_vm","this","_c","_self","staticRenderFns","create","svg_elem","innerHTML","set_status","msg","svg","d3","append","attr","text","diagramcolor","diagramcolor_selected","diagramcolor_focused","update","usage_arr","onPeriodClicked","dateformat","usage_times","map","day_events","get_usage_time","longest_usage","Math","max","apply","padding","width","center_elem","floor","_each","events","i","usage_time","height","date","moment","timestamp","subtract","get_hour_offset","format","color","offset","x","isSame","rect","style","on","e","target","attributes","seconds_to_duration","day_event","_head","_filter","data","status","duration","name","props","periodusage_arr","type","Array","watch","periodusage","$el","mounted","methods","period","$emit","component","arrayFilter","baseIteratee","filter"],"sourceRoot":""}