(self["webpackChunkaw_webui"]=self["webpackChunkaw_webui"]||[]).push([[2024],{912:t=>{function e(t){return t&&t.length?t[0]:void 0}t.exports=e},22024:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>J});var n,r,i,s,l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"sunburst"},[t._m(0),e("div",{staticClass:"main"},[e("div",{staticClass:"chart"},[e("div",{staticClass:"explanation"},[e("div",{staticClass:"base"},[t._v(t._s(t.centerMsg))]),t._m(1)])])])])},o=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"sidebar"},[e("div",{staticClass:"legend"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"hover",staticStyle:{visibility:"hidden"}},[e("div",{staticClass:"date"}),e("div",{staticClass:"title"}),e("div",{staticClass:"time"}),e("div",{staticClass:"duration"}),e("div",{staticClass:"data",staticStyle:{"text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden"}})])}],c=a(70068),u=a(1952),d=a(44384),h=a.n(d),f=a(56170),v=a.n(f),p=a(92078),m=a.n(p),y=a(33031),g=a.n(y),x=(a(80115),a(7899),a(59581),a(84095),a(10557),a(17),a(5086),a(19693),a(35231),a(30959),a(21243)),w=a(95093),b=a.n(w),k=a(71056),M=a(51278),C=750,A=600,O=Math.min(C,A)/2,_={afk:(0,M.nw)("afk"),"not-afk":(0,M.nw)("not-afk"),hibernating:(0,M.nw)("hibernating")};function I(){var t={w:75,h:30,s:3,r:3},e=x.select(".legend").append("svg:svg").attr("width",t.w).attr("height",Object.keys(_).length*(t.h+t.s)),a=e.selectAll("g").data(Object.entries(_).map((function(t){return{key:t[0],value:t[1]}}))).enter().append("svg:g").attr("transform",(function(e,a){return"translate(0,"+a*(t.h+t.s)+")"}));a.append("svg:rect").attr("rx",t.r).attr("ry",t.r).attr("width",t.w).attr("height",t.h).style("fill",(function(t){return t.value})),a.append("svg:text").attr("x",t.w/2).attr("y",t.h/2).attr("dy","0.35em").attr("text-anchor","middle").text((function(t){return t.key}))}function S(t){var e=Math.cos(t),a=Math.sin(t);r.append("line").attr("x1",170*e).attr("y1",170*a).attr("x2",155*e).attr("y2",155*a).style("stroke","#CCC").style("stroke-width",1)}function B(t,e,a){var n=2*Math.PI*(t/24+e/24/60)-.5*Math.PI;S(n);var i=Math.cos(n),s=Math.sin(n);r.append("text").text(a||b()({hours:t}).format("HH:mm")).attr("text-anchor","middle").attr("font-size","1.2em").style("fill","#999").attr("x",130*i).attr("y",5+140*s)}function q(t,e){console.log("Clicked",e)}function H(t){var e=x.select(".explanation > .hover"),a=t.data,n=b()(a.timestamp);e.select(".date").text(n.format("YYYY-MM-DD")),e.select(".time").text(n.format("HH:mm:ss"));var r=(0,k.seconds_to_duration)(a.duration);e.select(".duration").text(r),e.select(".title").text(a.data.app||a.data.status),e.select(".data").text(a.data.title||""),x.select(".explanation > .base").style("display","none"),e.style("visibility","")}function R(t,e){H(e);var a=e.ancestors().reverse();a.shift(),n.selectAll("path").style("opacity",.5),n.selectAll("path").filter((function(t){return a.indexOf(t)>=0})).style("opacity",1)}function z(){n.selectAll("path").on("mouseover",null),n.selectAll("path").transition().duration(100).style("opacity",1).on("end",(function(){x.select(this).on("mouseover",R)})),n.select(".explanation > .base").style("display",""),n.select(".explanation > .hover").style("visibility","hidden")}function N(){var t=x.select(".sequence").append("svg:svg").attr("width",C).attr("height",50).attr("id","trail");t.append("svg:text").attr("id","endlabel").style("fill","#000")}function P(t){n=x.select(t),n.selectAll("svg").remove(),r=n.append("svg:svg").attr("width",C).attr("height",A).append("svg:g").attr("id","container").attr("transform","translate("+C/2+","+A/2+")"),I(),i=x.partition().size([2*Math.PI,O*O]),s=x.arc().startAngle((function(t){return t.x0})).endAngle((function(t){return t.x1})).innerRadius((function(t){return Math.sqrt(t.y0)})).outerRadius((function(t){return Math.sqrt(t.y1)}))}function E(t,e){N(),t.querySelector("#container").innerHTML="",r.append("svg:circle").attr("r",O).style("opacity",0);var a,n=x.hierarchy(e),l=i(n),o=!0;if(o){var c=!0,u=b()(e.timestamp),d=u.clone().add(e.duration,"seconds");if(c){u=u.startOf("day"),d=u.clone().endOf("day"),B(0,0),B(6,0),B(12,0),B(18,0);var h=b()();B(h.hour(),h.minute(),"Now")}a=l.each((function(t){var e=b()(t.data.timestamp).diff(u,"seconds",!0),a=b()(t.data.timestamp).add(t.data.duration,"seconds").diff(u,"seconds",!0),n=Math.max(0,e/((d.valueOf()-u.valueOf())/1e3)),r=Math.min(1,a/((d.valueOf()-u.valueOf())/1e3));t.x0=2*Math.PI*n,t.x1=2*Math.PI*r})).descendants()}else n=n.sum((function(t){return t.duration})).sort((function(t,e){return JSON.stringify(t.data.data).localeCompare(JSON.stringify(e.data.data))})),a=l.descendants();a=a.filter((function(t){var e=.001;return t.x1-t.x0>e})),r.data([e]).selectAll("path").data(a).enter().append("svg:path").attr("display",(function(t){return t.depth?null:"none"})).attr("d",s).attr("fill-rule","evenodd").style("fill",(function(t){var e=t.data;return(0,M.nw)(e.data.status||e.data.app)})).style("opacity",1).on("mouseover",R).on("click",q),x.select("#container").on("mouseleave",z)}const T={create:P,update:E},Y={name:"aw-sunburst-clock",props:{date:{type:String},afkBucketId:{type:String},windowBucketId:{type:String}},data:function(){return{starttime:b()(),endtime:b()(),centerMsg:"Loading..."}},watch:{date:function(t){this.starttime=b()(t),this.endtime=b()(this.starttime).add(1,"days"),this.visualize()}},mounted:function(){T.create(this.$el),this.starttime=b()(this.date),this.endtime=b()(this.date).add(1,"days"),this.visualize()},methods:{todaysEvents:function(){var t=(0,u.A)((0,c.A)().mark((function t(e){var a,n;return(0,c.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=['RETURN = flood(query_bucket("'.concat(e,'"));')],t.next=3,this.$aw.query(["".concat(this.starttime.format(),"/").concat(this.endtime.format())],a);case 3:return n=t.sent,t.abrupt("return",n[0]);case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),visualize:function(){var t=this;function e(t,e){t=g()(t,"timestamp","desc"),e=g()(e,"timestamp","desc");for(var a=0,n=0;n<t.length;n++){var r=t[n],i=b()(r.timestamp),s=i.clone().add(r.duration,"seconds");r.children=[];while(a<e.length){var l=e[a],o=b()(l.timestamp),c=o.clone().add(l.duration,"seconds"),u=c.isBefore(i),d=o.isAfter(i)&&c.isBefore(s),f=o.isAfter(s);if(u)a++;else if(d)r.children=m()(r.children,l),a++;else{if(f)break;console.warn("Between parents"),r.children=m()(r.children,l),a++}}}var p=b()(v()(t).timestamp),y=b()(h()(t).timestamp),x=(y-p)/1e3;return{timestamp:v()(t).timestamp,duration:x,data:{title:"ROOT"},children:t}}this.todaysEvents(this.afkBucketId).then((function(a){t.todaysEvents(t.windowBucketId).then((function(n){var r=null;a.length>0&&n.length>0?(r=e(a,n),t.centerMsg="Hover to inspect"):(r={timestamp:"",duration:0,data:{title:"ROOT"},children:[]},t.centerMsg="No data"),T.update(t.$el,r)}))}))}}},D=Y;var $=a(81656),j=(0,$.A)(D,l,o,!1,null,"03d99ac2",null);const J=j.exports},25160:t=>{function e(t,e,a){var n=-1,r=t.length;e<0&&(e=-e>r?0:r+e),a=a>r?r:a,a<0&&(a+=r),r=e>a?0:a-e>>>0,e>>>=0;var i=Array(r);while(++n<r)i[n]=t[n+e];return i}t.exports=e},32865:(t,e,a)=>{var n=a(97189),r=a(51811),i=r(n);t.exports=i},33031:(t,e,a)=>{var n=a(83120),r=a(46155),i=a(69302),s=a(36800),l=i((function(t,e){if(null==t)return[];var a=e.length;return a>1&&s(t,e[0],e[1])?e=[]:a>2&&s(e[0],e[1],e[2])&&(e=[e[0]]),r(t,n(e,1),[])}));t.exports=l},36800:(t,e,a)=>{var n=a(75288),r=a(64894),i=a(30361),s=a(23805);function l(t,e,a){if(!s(a))return!1;var l=typeof e;return!!("number"==l?r(a)&&i(e,a.length):"string"==l&&e in a)&&n(a[e],t)}t.exports=l},37334:t=>{function e(t){return function(){return t}}t.exports=e},44384:(t,e,a)=>{var n=a(25160);function r(t){var e=null==t?0:t.length;return e?n(t,1,e):[]}t.exports=r},51811:t=>{var e=800,a=16,n=Date.now;function r(t){var r=0,i=0;return function(){var s=n(),l=a-(s-i);if(i=s,l>0){if(++r>=e)return arguments[0]}else r=0;return t.apply(void 0,arguments)}}t.exports=r},56170:(t,e,a)=>{t.exports=a(912)},56757:(t,e,a)=>{var n=a(91033),r=Math.max;function i(t,e,a){return e=r(void 0===e?t.length-1:e,0),function(){var i=arguments,s=-1,l=r(i.length-e,0),o=Array(l);while(++s<l)o[s]=i[e+s];s=-1;var c=Array(e+1);while(++s<e)c[s]=i[s];return c[e]=a(o),n(t,this,c)}}t.exports=i},69302:(t,e,a)=>{var n=a(83488),r=a(56757),i=a(32865);function s(t,e){return i(r(t,e,n),t+"")}t.exports=s},91033:t=>{function e(t,e,a){switch(a.length){case 0:return t.call(e);case 1:return t.call(e,a[0]);case 2:return t.call(e,a[0],a[1]);case 3:return t.call(e,a[0],a[1],a[2])}return t.apply(e,a)}t.exports=e},92078:(t,e,a)=>{var n=a(14528),r=a(83120),i=a(23007),s=a(56449);function l(){var t=arguments.length;if(!t)return[];var e=Array(t-1),a=arguments[0],l=t;while(l--)e[l-1]=arguments[l];return n(s(a)?i(a):[a],r(e,1))}t.exports=l},97189:(t,e,a)=>{var n=a(37334),r=a(93243),i=a(83488),s=r?function(t,e){return r(t,"toString",{configurable:!0,enumerable:!1,value:n(e),writable:!0})}:i;t.exports=s}}]);
//# sourceMappingURL=2024.edc824af.js.map